['run_exp.py', '0', 'UMLS', '50', '5e-4', 'zscore', '32', '30', '0', '1', 'simple', '0']
loading NN
done loading NN
loading dataset
UMLS
X_p: torch.Size([5216, 37])
X_p: torch.Size([661, 37])
X_p: torch.Size([652, 37])
done loading dataset
loading filters
done loading filters
loading negative samplers
loading triple features from cache
loading precalculated corruptions from cache
done loading negative samplers
running training and eval
TWIG_KGL_v0(
  (linear_struct_1): Linear(in_features=22, out_features=10, bias=True)
  (relu_1): ReLU()
  (dropout_1): Dropout(p=0.01, inplace=False)
  (linear_struct_2): Linear(in_features=10, out_features=10, bias=True)
  (relu_2): ReLU()
  (dropout_2): Dropout(p=0.01, inplace=False)
  (linear_final): Linear(in_features=10, out_features=1, bias=True)
  (sigmoid_final): Sigmoid()
)
REC: Training with epochs = 50
Epoch 1 -- batch 0 / 163 loss: 0.1785469800233841

==================================
Validation: dataloader for dataset UMLS
mr: 127.93558502197266
mrr: 0.1362675279378891
h1: 0.10736196488142014
h3: 0.12883435189723969
h5: 0.14570552110671997
h10: 0.1809815913438797
==================================

Epoch 2 -- batch 0 / 163 loss: 0.12176407873630524

==================================
Validation: dataloader for dataset UMLS
mr: 95.96932220458984
mrr: 0.17083781957626343
h1: 0.13036809861660004
h3: 0.15644171833992004
h5: 0.17944785952568054
h10: 0.25460124015808105
==================================

Epoch 3 -- batch 0 / 163 loss: 0.05148160085082054

==================================
Validation: dataloader for dataset UMLS
mr: 57.4263801574707
mrr: 0.30643072724342346
h1: 0.25460124015808105
h3: 0.30368098616600037
h5: 0.3328220844268799
h10: 0.4110429584980011
==================================

Epoch 4 -- batch 0 / 163 loss: 0.03338804095983505

==================================
Validation: dataloader for dataset UMLS
mr: 27.68251609802246
mrr: 0.5461441874504089
h1: 0.4861963093280792
h3: 0.5598159432411194
h5: 0.5858895778656006
h10: 0.6779140830039978
==================================

Epoch 5 -- batch 0 / 163 loss: 0.032148271799087524
NOT Saving checkpoint at epoch 5

==================================
Validation: dataloader for dataset UMLS
mr: 15.113496780395508
mrr: 0.7472162246704102
h1: 0.7101227045059204
h3: 0.75
h5: 0.7745398879051208
h10: 0.842024564743042
==================================

Epoch 6 -- batch 0 / 163 loss: 0.05167272314429283

==================================
Validation: dataloader for dataset UMLS
mr: 10.884969711303711
mrr: 0.8231373429298401
h1: 0.7883435487747192
h3: 0.842024564743042
h5: 0.8573619723320007
h10: 0.8865030407905579
==================================

Epoch 7 -- batch 0 / 163 loss: 0.04578714072704315

==================================
Validation: dataloader for dataset UMLS
mr: 7.230828285217285
mrr: 0.8718051314353943
h1: 0.8435583114624023
h3: 0.8834356069564819
h5: 0.9033742547035217
h10: 0.9187116622924805
==================================

Epoch 8 -- batch 0 / 163 loss: 0.049986936151981354

==================================
Validation: dataloader for dataset UMLS
mr: 5.871165752410889
mrr: 0.899965226650238
h1: 0.8757668733596802
h3: 0.9202454090118408
h5: 0.9279140830039978
h10: 0.9386503100395203
==================================

Epoch 9 -- batch 0 / 163 loss: 0.04083988443017006

==================================
Validation: dataloader for dataset UMLS
mr: 7.469325065612793
mrr: 0.9015355110168457
h1: 0.8849693536758423
h3: 0.9095091819763184
h5: 0.9248466491699219
h10: 0.9294478297233582
==================================

Epoch 10 -- batch 0 / 163 loss: 0.047165822237730026
NOT Saving checkpoint at epoch 10

==================================
Validation: dataloader for dataset UMLS
mr: 4.886503219604492
mrr: 0.9204574227333069
h1: 0.900306761264801
h3: 0.9294478297233582
h5: 0.9447852969169617
h10: 0.9601227045059204
==================================

Epoch 11 -- batch 0 / 163 loss: 0.03893325477838516

==================================
Validation: dataloader for dataset UMLS
mr: 5.374233245849609
mrr: 0.9234392642974854
h1: 0.9125766754150391
h3: 0.9248466491699219
h5: 0.9309815764427185
h10: 0.946319043636322
==================================

Epoch 12 -- batch 0 / 163 loss: 0.04275203496217728

==================================
Validation: dataloader for dataset UMLS
mr: 5.188650131225586
mrr: 0.926017165184021
h1: 0.9141104221343994
h3: 0.9294478297233582
h5: 0.9355828166007996
h10: 0.949386477470398
==================================

Epoch 13 -- batch 0 / 163 loss: 0.03797701373696327

==================================
Validation: dataloader for dataset UMLS
mr: 4.104294300079346
mrr: 0.9377728700637817
h1: 0.9263803958892822
h3: 0.9401840567588806
h5: 0.9478527903556824
h10: 0.9631901979446411
==================================

Epoch 14 -- batch 0 / 163 loss: 0.046613119542598724

==================================
Validation: dataloader for dataset UMLS
mr: 4.731595039367676
mrr: 0.9321545362472534
h1: 0.9217791557312012
h3: 0.9355828166007996
h5: 0.941717803478241
h10: 0.9524539709091187
==================================

Epoch 15 -- batch 0 / 163 loss: 0.030363628640770912
NOT Saving checkpoint at epoch 15

==================================
Validation: dataloader for dataset UMLS
mr: 3.3696320056915283
mrr: 0.9450550675392151
h1: 0.9340490698814392
h3: 0.9509202241897583
h5: 0.9585889577865601
h10: 0.9647239446640015
==================================

Epoch 16 -- batch 0 / 163 loss: 0.06030626967549324

==================================
Validation: dataloader for dataset UMLS
mr: 3.5674846172332764
mrr: 0.9399843811988831
h1: 0.9309815764427185
h3: 0.941717803478241
h5: 0.949386477470398
h10: 0.9570552110671997
==================================

Epoch 17 -- batch 0 / 163 loss: 0.05713414028286934

==================================
Validation: dataloader for dataset UMLS
mr: 3.0812883377075195
mrr: 0.9405117630958557
h1: 0.9263803958892822
h3: 0.949386477470398
h5: 0.9524539709091187
h10: 0.9693251252174377
==================================

Epoch 18 -- batch 0 / 163 loss: 0.034022510051727295

==================================
Validation: dataloader for dataset UMLS
mr: 4.032208442687988
mrr: 0.9301027655601501
h1: 0.9141104221343994
h3: 0.9386503100395203
h5: 0.9432515501976013
h10: 0.9585889577865601
==================================

Epoch 19 -- batch 0 / 163 loss: 0.03756333887577057

==================================
Validation: dataloader for dataset UMLS
mr: 3.6150307655334473
mrr: 0.9349799752235413
h1: 0.9187116622924805
h3: 0.9447852969169617
h5: 0.9478527903556824
h10: 0.9631901979446411
==================================

Epoch 20 -- batch 0 / 163 loss: 0.059630751609802246
NOT Saving checkpoint at epoch 20

==================================
Validation: dataloader for dataset UMLS
mr: 3.4003067016601562
mrr: 0.9317392110824585
h1: 0.9156441688537598
h3: 0.941717803478241
h5: 0.949386477470398
h10: 0.953987717628479
==================================

Epoch 21 -- batch 0 / 163 loss: 0.043755754828453064

==================================
Validation: dataloader for dataset UMLS
mr: 3.7776074409484863
mrr: 0.9322063326835632
h1: 0.9202454090118408
h3: 0.9371165633201599
h5: 0.941717803478241
h10: 0.9555214643478394
==================================

Epoch 22 -- batch 0 / 163 loss: 0.036198992282152176

==================================
Validation: dataloader for dataset UMLS
mr: 3.259202480316162
mrr: 0.9356428980827332
h1: 0.9202454090118408
h3: 0.9432515501976013
h5: 0.9478527903556824
h10: 0.9662576913833618
==================================

Epoch 23 -- batch 0 / 163 loss: 0.037376560270786285

==================================
Validation: dataloader for dataset UMLS
mr: 3.2515337467193604
mrr: 0.9333407878875732
h1: 0.9202454090118408
h3: 0.9386503100395203
h5: 0.9447852969169617
h10: 0.9585889577865601
==================================

Epoch 24 -- batch 0 / 163 loss: 0.03561485931277275

==================================
Validation: dataloader for dataset UMLS
mr: 3.0153374671936035
mrr: 0.9410111308097839
h1: 0.9263803958892822
h3: 0.949386477470398
h5: 0.9570552110671997
h10: 0.9662576913833618
==================================

Epoch 25 -- batch 0 / 163 loss: 0.04557199031114578
NOT Saving checkpoint at epoch 25

==================================
Validation: dataloader for dataset UMLS
mr: 3.556748390197754
mrr: 0.9306895136833191
h1: 0.9125766754150391
h3: 0.9371165633201599
h5: 0.9509202241897583
h10: 0.9662576913833618
==================================

Epoch 26 -- batch 0 / 163 loss: 0.03926079720258713

==================================
Validation: dataloader for dataset UMLS
mr: 3.788343667984009
mrr: 0.9287947416305542
h1: 0.9125766754150391
h3: 0.9355828166007996
h5: 0.9447852969169617
h10: 0.9601227045059204
==================================

Epoch 27 -- batch 0 / 163 loss: 0.03529100865125656

==================================
Validation: dataloader for dataset UMLS
mr: 3.398772954940796
mrr: 0.9310926198959351
h1: 0.9156441688537598
h3: 0.9355828166007996
h5: 0.949386477470398
h10: 0.9647239446640015
==================================

Epoch 28 -- batch 0 / 163 loss: 0.0385768823325634

==================================
Validation: dataloader for dataset UMLS
mr: 3.200920343399048
mrr: 0.9336093664169312
h1: 0.9217791557312012
h3: 0.9355828166007996
h5: 0.946319043636322
h10: 0.9631901979446411
==================================

Epoch 29 -- batch 0 / 163 loss: 0.038462813943624496

==================================
Validation: dataloader for dataset UMLS
mr: 3.096625804901123
mrr: 0.9341354966163635
h1: 0.9202454090118408
h3: 0.9371165633201599
h5: 0.946319043636322
h10: 0.9677914381027222
==================================

Epoch 30 -- batch 0 / 163 loss: 0.026046114042401314
NOT Saving checkpoint at epoch 30

==================================
Validation: dataloader for dataset UMLS
mr: 3.2914111614227295
mrr: 0.9367005228996277
h1: 0.9263803958892822
h3: 0.9355828166007996
h5: 0.946319043636322
h10: 0.9631901979446411
==================================

Epoch 31 -- batch 0 / 163 loss: 0.020778635516762733

==================================
Validation: dataloader for dataset UMLS
mr: 3.030674934387207
mrr: 0.9477050304412842
h1: 0.9371165633201599
h3: 0.953987717628479
h5: 0.9601227045059204
h10: 0.9708588719367981
==================================

Epoch 32 -- batch 0 / 163 loss: 0.02437344565987587

==================================
Validation: dataloader for dataset UMLS
mr: 3.1472392082214355
mrr: 0.9490740299224854
h1: 0.941717803478241
h3: 0.949386477470398
h5: 0.9555214643478394
h10: 0.9677914381027222
==================================

Epoch 33 -- batch 0 / 163 loss: 0.023275166749954224

==================================
Validation: dataloader for dataset UMLS
mr: 3.3389570713043213
mrr: 0.9464218020439148
h1: 0.9371165633201599
h3: 0.9478527903556824
h5: 0.9601227045059204
h10: 0.9631901979446411
==================================

Epoch 34 -- batch 0 / 163 loss: 0.02552996203303337

==================================
Validation: dataloader for dataset UMLS
mr: 3.297545909881592
mrr: 0.9478110074996948
h1: 0.9401840567588806
h3: 0.949386477470398
h5: 0.9555214643478394
h10: 0.9616564512252808
==================================

Epoch 35 -- batch 0 / 163 loss: 0.01885741762816906
NOT Saving checkpoint at epoch 35

==================================
Validation: dataloader for dataset UMLS
mr: 3.288343667984009
mrr: 0.9559130668640137
h1: 0.949386477470398
h3: 0.9570552110671997
h5: 0.9631901979446411
h10: 0.9693251252174377
==================================

Epoch 36 -- batch 0 / 163 loss: 0.018093647435307503

==================================
Validation: dataloader for dataset UMLS
mr: 3.2776074409484863
mrr: 0.9564013481140137
h1: 0.9478527903556824
h3: 0.9585889577865601
h5: 0.9693251252174377
h10: 0.9785276055335999
==================================

Epoch 37 -- batch 0 / 163 loss: 0.02444097399711609

==================================
Validation: dataloader for dataset UMLS
mr: 3.0460121631622314
mrr: 0.9625447988510132
h1: 0.953987717628479
h3: 0.9693251252174377
h5: 0.9754601120948792
h10: 0.9800613522529602
==================================

Epoch 38 -- batch 0 / 163 loss: 0.018236983567476273

==================================
Validation: dataloader for dataset UMLS
mr: 3.038343667984009
mrr: 0.9557600617408752
h1: 0.946319043636322
h3: 0.9585889577865601
h5: 0.9647239446640015
h10: 0.9754601120948792
==================================

Epoch 39 -- batch 0 / 163 loss: 0.017032409086823463

==================================
Validation: dataloader for dataset UMLS
mr: 3.0981595516204834
mrr: 0.9594756364822388
h1: 0.9524539709091187
h3: 0.9616564512252808
h5: 0.9677914381027222
h10: 0.9769938588142395
==================================

Epoch 40 -- batch 0 / 163 loss: 0.01395567599684
NOT Saving checkpoint at epoch 40

==================================
Validation: dataloader for dataset UMLS
mr: 3.372699499130249
mrr: 0.9617588520050049
h1: 0.953987717628479
h3: 0.9631901979446411
h5: 0.9693251252174377
h10: 0.9800613522529602
==================================

Epoch 41 -- batch 0 / 163 loss: 0.016977351158857346

==================================
Validation: dataloader for dataset UMLS
mr: 3.41717791557312
mrr: 0.9632386565208435
h1: 0.9570552110671997
h3: 0.9647239446640015
h5: 0.9677914381027222
h10: 0.9769938588142395
==================================

Epoch 42 -- batch 0 / 163 loss: 0.01772390305995941

==================================
Validation: dataloader for dataset UMLS
mr: 3.2177913188934326
mrr: 0.9633554816246033
h1: 0.9570552110671997
h3: 0.9647239446640015
h5: 0.9708588719367981
h10: 0.9800613522529602
==================================

Epoch 43 -- batch 0 / 163 loss: 0.012964902445673943

==================================
Validation: dataloader for dataset UMLS
mr: 3.3358895778656006
mrr: 0.9632818102836609
h1: 0.9570552110671997
h3: 0.9662576913833618
h5: 0.9708588719367981
h10: 0.9754601120948792
==================================

Epoch 44 -- batch 0 / 163 loss: 0.012897736392915249

==================================
Validation: dataloader for dataset UMLS
mr: 3.3220858573913574
mrr: 0.9610466361045837
h1: 0.9555214643478394
h3: 0.9601227045059204
h5: 0.9662576913833618
h10: 0.9723926186561584
==================================

Epoch 45 -- batch 0 / 163 loss: 0.01641617715358734
NOT Saving checkpoint at epoch 45

==================================
Validation: dataloader for dataset UMLS
mr: 3.2653374671936035
mrr: 0.9623686671257019
h1: 0.9570552110671997
h3: 0.9647239446640015
h5: 0.9677914381027222
h10: 0.9723926186561584
==================================

Epoch 46 -- batch 0 / 163 loss: 0.015173562802374363

==================================
Validation: dataloader for dataset UMLS
mr: 3.351227045059204
mrr: 0.9628466367721558
h1: 0.9585889577865601
h3: 0.9631901979446411
h5: 0.9693251252174377
h10: 0.9739263653755188
==================================

Epoch 47 -- batch 0 / 163 loss: 0.012851644307374954

==================================
Validation: dataloader for dataset UMLS
mr: 3.2576687335968018
mrr: 0.9633995294570923
h1: 0.9555214643478394
h3: 0.9693251252174377
h5: 0.9723926186561584
h10: 0.9754601120948792
==================================

Epoch 48 -- batch 0 / 163 loss: 0.01374892983585596

==================================
Validation: dataloader for dataset UMLS
mr: 3.2438650131225586
mrr: 0.9670438170433044
h1: 0.9616564512252808
h3: 0.9693251252174377
h5: 0.9708588719367981
h10: 0.9754601120948792
==================================

Epoch 49 -- batch 0 / 163 loss: 0.013652307912707329

==================================
Validation: dataloader for dataset UMLS
mr: 2.929447889328003
mrr: 0.9668853282928467
h1: 0.9631901979446411
h3: 0.9662576913833618
h5: 0.9723926186561584
h10: 0.9785276055335999
==================================

Epoch 50 -- batch 0 / 163 loss: 0.010309236124157906
NOT Saving checkpoint at epoch 50
Done Training!

==================================
Testing (cite this): dataloader for dataset UMLS
Testing (cite this): batch 0 / 21
ranks: tensor([  1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,  16.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1., 243.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   3.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1., 120.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
         20.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1., 235.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   3.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   7.,   1.,   1.,   1.,   3.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   2.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   7.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1., 182.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   3.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   4.,  30.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,  44.,   1.,   1.,
          1.,   1.,   6.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
          1.])
mr: 2.3782148361206055
mrr: 0.9784061312675476
h1: 0.974281370639801
h3: 0.9818456768989563
h5: 0.9833585619926453
h10: 0.9878970980644226
==================================

Done Testing!
done with training and eval
Experiments took 299 seconds
